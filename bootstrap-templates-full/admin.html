<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מערכת ניהול אירועים - אדמין</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="bg-light">
    <div class="container-fluid">
        <!-- Header -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm mb-4">
            <div class="container-fluid">
                <span class="navbar-brand fw-bold">
                    <i class="bi bi-calendar-event me-2"></i>
                    מערכת ניהול אירועים
                </span>
                <div class="d-flex align-items-center">
                    <span class="text-light me-3" id="selectedEventName">אדמין</span>
                    <button class="btn btn-outline-light btn-sm" onclick="logout()">
                        <i class="bi bi-box-arrow-right me-1"></i>
                        התנתק
                    </button>
                </div>
            </div>
        </nav>

        <div class="container-fluid">
            <!-- Event Manager -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow-sm">
                        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">
                                <i class="bi bi-calendar-plus me-2"></i>
                                ניהול אירועים
                            </h5>
                            <button class="btn btn-light btn-sm" data-bs-toggle="modal" data-bs-target="#createEventModal">
                                <i class="bi bi-plus-lg me-1"></i>
                                הוסף אירוע חדש
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="eventsContainer" class="row g-3">
                                <!-- Events will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics -->
            <div class="row mb-4" id="statsContainer" style="display: none;">
                <div class="col-md-4">
                    <div class="card bg-success text-white shadow-sm">
                        <div class="card-body text-center">
                            <div class="display-6 fw-bold" id="confirmedCount">0</div>
                            <p class="mb-0">אישרו הגעה</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card bg-warning text-dark shadow-sm">
                        <div class="card-body text-center">
                            <div class="display-6 fw-bold" id="pendingCount">0</div>
                            <p class="mb-0">ממתינים לתשובה</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card bg-info text-white shadow-sm">
                        <div class="card-body text-center">
                            <div class="display-6 fw-bold" id="totalGuestsCount">0</div>
                            <p class="mb-0">סה"כ מוזמנים</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Management Tabs -->
            <div class="card shadow-sm">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs" id="managementTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="guests-tab" data-bs-toggle="tab" data-bs-target="#guests" type="button" role="tab">
                                <i class="bi bi-people me-1"></i>
                                אורחים
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="import-tab" data-bs-toggle="tab" data-bs-target="#import" type="button" role="tab">
                                <i class="bi bi-file-excel me-1"></i>
                                יבוא
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="links-tab" data-bs-toggle="tab" data-bs-target="#links" type="button" role="tab">
                                <i class="bi bi-link me-1"></i>
                                קישורים
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="invitations-tab" data-bs-toggle="tab" data-bs-target="#invitations" type="button" role="tab">
                                <i class="bi bi-card-image me-1"></i>
                                הזמנות
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="colors-tab" data-bs-toggle="tab" data-bs-target="#colors" type="button" role="tab">
                                <i class="bi bi-palette me-1"></i>
                                צבעים
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="export-tab" data-bs-toggle="tab" data-bs-target="#export" type="button" role="tab">
                                <i class="bi bi-download me-1"></i>
                                ייצוא
                            </button>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    <div class="tab-content" id="managementTabsContent">
                        <!-- Guests Tab -->
                        <div class="tab-pane fade show active" id="guests" role="tabpanel">
                            <div class="row g-4">
                                <div class="col-lg-6">
                                    <!-- Guest Manager -->
                                    <div class="card">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h6 class="mb-0">
                                                <i class="bi bi-person-plus me-2"></i>
                                                ניהול אורחים
                                            </h6>
                                            <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addGuestModal">
                                                <i class="bi bi-plus-lg me-1"></i>
                                                הוסף אורח
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div id="guestManagerContent">
                                                <div class="text-center py-4 text-muted">
                                                    בחר אירוע כדי לנהל אורחים
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <!-- Guest List -->
                                    <div class="card">
                                        <div class="card-header">
                                            <h6 class="mb-0">
                                                <i class="bi bi-list-check me-2"></i>
                                                רשימת מוזמנים
                                            </h6>
                                        </div>
                                        <div class="card-body">
                                            <div id="guestListContent">
                                                <div class="text-center py-4 text-muted">
                                                    בחר אירוע כדי לראות את רשימת המוזמנים
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Import Tab -->
                        <div class="tab-pane fade" id="import" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="bi bi-file-excel me-2"></i>
                                        יבוא מקובץ Excel
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div id="importContent">
                                        <div class="text-center py-4 text-muted">
                                            בחר אירוע כדי להעלות קובץ אורחים
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Links Tab -->
                        <div class="tab-pane fade" id="links" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="bi bi-link me-2"></i>
                                        ניהול קישורים מותאמים
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div id="linksContent">
                                        <div class="text-center py-4 text-muted">
                                            בחר אירוע כדי לנהל קישורים
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Invitations Tab -->
                        <div class="tab-pane fade" id="invitations" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="bi bi-card-image me-2"></i>
                                        ניהול הזמנות
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div id="invitationsContent">
                                        <div class="text-center py-4 text-muted">
                                            בחר אירוע כדי לנהל הזמנות
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Colors Tab -->
                        <div class="tab-pane fade" id="colors" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="bi bi-palette me-2"></i>
                                        ניהול צבעים ועיצוב
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div id="colorsContent">
                                        <div class="text-center py-4 text-muted">
                                            בחר אירוע כדי לערוך צבעים
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Export Tab -->
                        <div class="tab-pane fade" id="export" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="bi bi-download me-2"></i>
                                        ייצוא נתונים
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div id="exportContent">
                                        <div class="text-center py-4 text-muted">
                                            בחר אירוע כדי לייצא את הנתונים
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Event Modal -->
    <div class="modal fade" id="createEventModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">יצירת אירוע חדש</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="createEventForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">שם האירוע *</label>
                            <input type="text" class="form-control" id="eventName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">תיאור האירוע</label>
                            <textarea class="form-control" id="eventDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">תאריך האירוע *</label>
                            <input type="date" class="form-control" id="eventDate" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">תמונת הזמנה</label>
                            <input type="file" class="form-control" id="eventImage" accept="image/*">
                            <div class="form-text">עד 5MB, פורמטים נתמכים: JPG, PNG, GIF</div>
                            <div id="imagePreview" class="mt-2" style="display: none;">
                                <div class="d-flex align-items-center">
                                    <span class="text-success me-2">✓</span>
                                    <span id="imageName"></span>
                                    <button type="button" class="btn btn-sm text-danger ms-auto" onclick="removeImage()">×</button>
                                </div>
                                <small class="text-muted d-block" id="imageSize"></small>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ביטול</button>
                        <button type="submit" class="btn btn-primary">צור אירוע</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Guest Modal -->
    <div class="modal fade" id="addGuestModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">הוספת אורח חדש</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="addGuestForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">שם מלא *</label>
                            <input type="text" class="form-control" id="guestName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">מספר טלפון *</label>
                            <input type="tel" class="form-control" id="guestPhone" placeholder="05X-XXXXXXX" dir="ltr" required>
                            <div class="form-text">מספר טלפון ישראלי - 10 ספרות מתחיל ב-05</div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ביטול</button>
                        <button type="submit" class="btn btn-primary">הוסף אורח</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" id="toastContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="admin.js"></script>
</body>
</html>